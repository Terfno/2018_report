# 2018/11/12 マイコン1
## issue
* [x] 課題5のレイアウト崩れ
* [x] 表紙のミス
## 目的
今回は、前学期のマイクロコンピューター基礎で行ったアセンブリ言語の復習を行う。
今回復習するのは、データの転送、ループ、条件分岐、LEDの制御である。

## 使用装置
MT-Zを用いる

## 実験
### 課題1
8500Hの数値に5を足した数値を、8501Hに書き込むプログラムを作りなさい。

プログラムを図1.1に示す。


| アドレス | 機械語      | ニーモニック        | コメント             | 
|------|----------|---------------|------------------| 
| 8400 |          | ORG 8400H     |                  | 
| 8400 | 3A 00 85 | LD A, (8500H) | 8500Hの値をAレジスタに転送 | 
| 8403 | C6 5     | ADD A, 05H    | Aレジスタの値に5を足す     | 
| 8405 | 32 01 85 | LD (8501H), A | Aレジスタの値を8501Hに転送 | 
| 8408 | C3 00 00 | JP 0000H      | モニタプログラムにジャンプ    | 
|      |          |               |                  | 
| 8500 |          | ORG 8500H     |                  | 
| 8500 | 1        | DB 01H        | 01Hを入れておく        | 
| 8501 | 0        | END           | 仮に0Hを入れておく       | 

<div style="text-align:center;">図1.1 課題1</div>

### 課題2
8500Hと8501Hの数値を足した数値を8502Hに書き込むプログラムを作りなさい。

プログラムを図1.2に示す。


| アドレス | 機械語      | ニーモニック        | コメント              | 
|------|----------|---------------|-------------------| 
|      |          | ORG 8400H     |                   | 
| 8400 | 3A 00 85 | LD A, (8500H) | 8500Hの内容をAレジスタに転送 | 
| 8403 | 47       | LD B, A       | Aレジスタの内容をBレジスタに転送 | 
| 8404 | 3A 01 85 | LD A, (8501H) | 8501Hの内容をAレジスタに転送 | 
| 8407 | 80       | ADD A, B      | AにBを加える           | 
| 8408 | 32 02 85 | LD (8502H), A | Aレジスタの内容を8502Hに転送 | 
| 840b | C3 00 00 | JP 0000H      | モニタプログラムにジャンプ     | 
|      |          |               |                   | 
| 8500 |          | ORG 8500H     |                   | 
| 8500 | 1        | DB 01H        | 01Hを入れておく         | 
| 8501 | 2        | DB 02H        | 02Hを入れておく         | 
| 8502 | 0        | DB 00H        | 仮に0を入れておく         | 

<div style="text-align:center;">図1.2 課題2</div>

### 課題3
8500Hと8501Hの数値を比較し、大きい方を8502Hに書き込むプログラムを作りなさい
* データを比較するときには`CP`を使います。
比較した結果はフラグレジスタに保存されます。
* プログラムの任意の場所にジャンプするときは`JP`を用います。
`JP 番地`で無条件に任意の番地にジャンプし、`JP X 番地`でフラグレジスタが`X`の時に任意の番地にジャンプします。

プログラムを図1.3に示す。


| アドレス | 機械語      | ラベル   | ニーモニック        | コメント                  | 
|------|----------|-------|---------------|-----------------------| 
| 8400 |          |       | ORG 8400H     |                       | 
| 8400 | 3A 00 85 |       | LD A, (8500H) | 8500Hの値をAレジスタに転送      | 
| 8403 | 47       |       | LD B, A       | Aレジスタの値をBレジスタに転送      | 
| 8404 | 3A 01 85 |       | LD A, (8501H) | 8501Hの値をAレジスタに転送      | 
| 8407 | B8       |       | CP B          | Bと比較                  | 
| 8408 | F2 12 84 |       | JP P, MORE    | フラグレジスタが正ならばMOREにジャンプ | 
| 840b | 78       |       | LD A, B       | Bレジスタの値をAレジスタに転送      | 
| 840c | 32 02 85 |       | LD (8502H), A | Aレジスタの値を8502Hに転送      | 
| 840f | C3 00 00 |       | JP 0000H      | モニタプログラムにジャンプ         | 
|      |          |       |               |                       | 
| 8412 | 32 02 85 | MORE: | LD (8502H), A | Aレジスタの値を8502Hに転送      | 
| 8415 | C3 00 00 |       | JP 0000H      | モニタプログラムにジャンプ         | 
|      |          |       |               |                       | 
| 8500 |          |       | ORG 8500H     |                       | 
| 8500 | 1        |       | DB 01H        | 01Hを入力しておく            | 
| 8501 | 3        |       | DB 03H        | 03Hを入力しておく            | 
| 8502 | 0        |       | DB 00H        | 仮に00Hを入力しておく          | 

<div style="text-align:center;">図1.3 課題3</div>

### 課題4
10から1ずつ引いていき、5以下になった場合終了するプログラムを作りなさい
プログラムを図1.4に示す。

| アドレス | 機械語      | ラベル   | ニーモニック        | コメント                   | 
|------|----------|-------|---------------|------------------------| 
| 8400 |          |       | ORG 8400H     |                        | 
| 8400 | 3A 00 85 |       | LD A, (8500H) | 8500Hの値をAレジスタに転送       | 
| 8403 | 3D       | LOOP: | DEC A         | Aから1を引く                | 
| 8404 | FE 05    |       | CP 05H        | 05Hと比較する               | 
| 8406 | C2 02 84 |       | JP NZ, LOOP   | フラグレジスタがNZならばLOOPにジャンプ | 
| 8409 | 32 00 85 |       | LD (8500H), A | Aレジスタの値を8500Hに転送       | 
| 840C | C3 00 00 |       | JP 0000H      | モニタプログラムにジャンプ          | 
| 8412 |          |       | END           |                        | 
|      |          |       |               |                        | 
| 8500 |          |       | ORG 8500      |                        | 
| 8500 | 0A       |       | DB 0AH        | 0AH(10進数で10)を入力しておく    | 

<div style="text-align:center;">図1.4 課題4</div>

### 課題5
図1.2を参考に1-10の和をメモリの8500H番地に書き込むプログラムを作りなさい

プログラムを図1.5に示す。


| アドレス | 機械語      | ラベル   | ニーモニック        | コメント                  | 
|------|----------|-------|---------------|-----------------------| 
| 8400 |          |       | ORG 8400H     |                       | 
| 8400 | 3E 00    |       | LD A, 0       | 0HをAレジスタに転送する         | 
| 8402 | 06 0A    |       | LD B, 0A      | 0AHをBレジスタに転送する        | 
| 8404 | 80       | LOOP: | ADD A, B      | AにBを加える               | 
| 8405 | 5        |       | DEC B         | Bから1を引く               | 
| 8406 | C2 04 84 |       | JP NZ, LOOP:  | フラグが0じゃないならばLOOPにジャンプ | 
| 8409 | 32 00 85 |       | LD (8500H), A | Aを8500にロード            | 
| 840C | C3 00 00 |       | JP 0000H      | モニタプログラムにジャンプ         | 
|      |          |       | END           |                       | 
|      |          |       |               |                       | 
|      |          |       | ORG 8500H     |                       | 
| 8500 | 0        |       | DB 01H        | 仮に00Hを入力しておく          | 

<div style="text-align:center;">図1.5 課題5</div>


### 課題6
LEDをすべて点灯させなさい

プログラムを図1.6に示す。
| アドレス | 機械語      | ニーモニック        | コメント                 | 
|------|----------|---------------|----------------------| 
| 5    |          | PB EQU 05H    | ポートBのアドレス            | 
| 7    |          | CTL EQU 07H   | コントロールポートのアドレス       | 
| 90   |          | CLWD EQU 90H  | コントロールワード            | 
|      |          |               |                      | 
| 8400 |          | ORG 8400H     |                      | 
| 8400 | 3E 90    | LD A, CLWD    | コントロールワードをAレジスタに転送   | 
| 8402 | D3 07    | OUT (CTL), A  | コントロールポートにAレジスタの値を出力 | 
| 8404 | 3A 00 85 | LD A, (8500A) | 8500Hの値をAレジスタに転送     | 
| 8407 | D3 05    | OUT (PB), A   | ポートBにAを出力            | 
| 8409 | C3 00 00 | JP 0000H      | モニタプログラムにジャンプ        | 
|      |          |               |                      | 
| 8500 |          | ORG 8500H     |                      | 
| 8500 | FF       | DB FFH        | FFHを予め入力しておく。        | 
| 8501 |          | END           |                      | 

<div style="text-align:center;">図1.6 課題6</div>

### 課題7
LED一つおきに点灯させなさい


プログラムを図1.7に示す。


| アドレス | 機械語      | ニーモニック        | コメント                 | 
|------|----------|---------------|----------------------| 
| 5    |          | PB EQU 05H    | ポートBのアドレス            | 
| 7    |          | CTL EQU 07H   | コントロールポートのアドレス       | 
| 90   |          | CLWD EQU 90H  | コントロールワード            | 
|      |          |               |                      | 
| 8400 |          | ORG 8400H     |                      | 
| 8400 | 3E 90    | LD A, CLWD    | コントロールワードをAレジスタに転送   | 
| 8402 | D3 07    | OUT (CTL), A  | コントロールポートにAレジスタの値を出力 | 
| 8404 | 3A 00 85 | LD A, (8500A) | 8500Hの値をAレジスタに転送     | 
| 8407 | D3 05    | OUT (PB), A   | ポートBにAを出力            | 
| 8409 | C3 00 00 | JP 0000H      | モニタプログラムにジャンプ        | 
|      |          |               |                      | 
| 8500 |          | ORG 8500H     |                      | 
| 8500 | AA       | DB AAH        | AAHを予め入力しておく。        | 
| 8501 |          | END           |                      | 

<div style="text-align:center;">図1.7 課題7</div>

### 課題8
LEDの一つおきの点灯が反転を繰り返すプログラムを作りなさい

プログラムを図1.8に示す。
| アドレス | 機械語      | ラベル    | ニーモニック       | コメント                    | 
|------|----------|--------|--------------|-------------------------| 
| 5    |          |        | PB EQU 05H   | ポートBのアドレス               | 
| 7    |          |        | CTL EQU 07H  | コントロールポートのアドレス          | 
| 90   |          |        | CLWD EQU 90H | コントロールワード               | 
|      |          |        |              |                         | 
| 8400 |          |        | ORG 8400H    |                         | 
| 8400 | 3E 90    |        | LD A, CLWD   | コントロールワードをAレジスタに転送      | 
| 8402 | D3 07    |        | OUT (CTL), A | コントロールポートにAレジスタの値を出力    | 
| 8404 | 3E AA    |        | LD A, 08H    | 値08HをAレジスタに転送           | 
| 8406 | D3 05    | SHIFT: | OUT (PB), A  | ポートBにAレジスタの値を出力         | 
| 8408 | EE FF    |        | XOR FFH      | AレジスタとFFHとの排他的論理和をとる    | 
| 840A | CD 40 84 |        | CALL TIMER   | タイマーを呼び出す               | 
| 840D | C3 06 84 |        | JP SHIFT     | シフトにジャンプ                | 
|      |          |        |              |                         | 
| 8440 |          |        | ORG 8440H    |                         | 
| 8440 | 21 00 40 | TIMER: | LD HL, 4000H | 値400HをHLレジスタに転送         | 
| 8443 | 5F       |        | LD E, A      | Aレジスタの値をEレジスタに転送        | 
| 8444 | 2B       | TLOOP: | DEC HL       | HLレジスタの値から１を引く          | 
| 8445 | 7C       |        | LD A, H      | Hレジスタの値をAレジスタに転送        | 
| 8446 | B5       |        | OR L         | Aの値とLの値の論理和をとる          | 
| 8447 | 20 FB    |        | JR NZ, TLOOP | フラグレジスタがNZならばTLOOPにジャンプ | 
| 8449 | 7B       |        | LD A,E       | Eレジスタの値をAレジスタに転送        | 
| 844A | C9       |        | RET          | ルーティン終了                 | 
| 844B |          |        | END          |                         | 

<div style="text-align:center;">図1.8 課題8</div>

### 課題9
図1.3を参考にLEDの点灯位置が左にシフトするプログラムを作りなさい

プログラムを図1.9に示す。
| アドレス | 機械語      | ラベル    | ニーモニック       | コメント                    | 
|------|----------|--------|--------------|-------------------------| 
| 5    |          |        | PB EQU 05H   | ポートBのアドレス               | 
| 7    |          |        | CTL EQU 07H  | コントロールポートのアドレス          | 
| 90   |          |        | CLWD EQU 90H | コントロールワード               | 
|      |          |        |              |                         | 
| 8400 |          |        | ORG 8400H    |                         | 
| 8400 | 3E 90    |        | LD A, CLWD   | コントロールワードをAレジスタに転送      | 
| 8402 | D3 07    |        | OUT (CTL), A | コントロールポートにAレジスタの値を出力    | 
| 8404 | 3E 01    |        | LD A, 01H    | 値08HをAレジスタに転送           | 
| 8406 | D3 05    | SHIFT: | OUT (PB), A  | ポートBにAレジスタの値を出力         | 
| 8408 | 7        |        | RLCA         | Aの内容を左にシフトする            | 
| 8409 | CD 40 84 |        | CALL TIMER   | タイマーを呼び出す               | 
| 840C | C3 06 84 |        | JP SHIFT     | シフトにジャンプ                | 
|      |          |        |              |                         | 
| 8440 |          |        | ORG 8440H    |                         | 
| 8440 | 21 00 40 | TIMER: | LD HL, 4000H | 値400HをHLレジスタに転送         | 
| 8443 | 5F       |        | LD E, A      | Aレジスタの値をEレジスタに転送        | 
| 8444 | 2B       | TLOOP: | DEC HL       | HLレジスタの値から１を引く          | 
| 8445 | 7C       |        | LD A, H      | Hレジスタの値をAレジスタに転送        | 
| 8446 | B5       |        | OR L         | Aの値とLの値の論理和をとる          | 
| 8447 | 20 FB    |        | JR NZ, TLOOP | フラグレジスタがNZならばTLOOPにジャンプ | 
| 8449 | 7B       |        | LD A,E       | Eレジスタの値をAレジスタに転送        | 
| 844A | C9       |        | RET          | ルーティン終了                 | 
| 844B |          |        | END          |                         | 

<div style="text-align:center;">図1.9 課題9</div>

### 課題10
LEDの点灯位置が、はじめに左にシフトし、左端にきたら右にシフト、右端にきたら左にシフトするようなプログラムを作りなさい。
プログラムを図1.10に示す。
| 8402 | D3 07    |         | OUT (CTL), A  | コントロールポートにAレジスタの値を出力    | 
|------|----------|---------|---------------|-------------------------| 
| 8404 | 3E 01    |         | LD A, 01H     | 値08HをAレジスタに転送           | 
| 8406 | D3 05    | SHIFTL: | OUT (PB), A   | ポートBにAレジスタの値を出力         | 
| 8408 | BF 80    |         | CP 80H        | Aレジスタと80Hを比較する          | 
| 840A | CA 17 84 |         | JP Z, SHIFTR  | 0ならば右シフトにジャンプ           | 
| 840D | C2 10 84 |         | JP NZ, NEXT   | 0じゃなければ次のアドレスにジャンプ      | 
| 8410 | 7        | NEXT:   | RLCA          | Aの内容を左にシフトする            | 
| 8411 | CD 40 84 |         | CALL TIMER    | タイマーを呼び出す               | 
| 8414 | C2 06 84 |         | JP NZ, SHIFTL | 0じゃなければ左シフトにジャンプ        | 
| 8417 | D3 05    | SHIFTR: | OUT (PB), A   | ポートBにAレジスタの値を出力         | 
| 8419 | BF 01    |         | CP 01H        | Aレジスタと01Hと比較する          | 
| 841B | CA 06 84 |         | JP Z, SHIFTL  | 0ならば左シフトにジャンプ           | 
| 841E | C2 21 84 |         | JP NZ, NEXT   | 0じゃなければ次のアドレスにジャンプ      | 
| 8421 | 0F       | NEXT:   | RRCA          | Aの内容を右にシフトする            | 
| 8422 | CD 40 84 |         | CALL TIMER    | タイマーを呼び出す               | 
| 8425 | C2 17 84 |         | JP NZ, SHIFTR | 0じゃなければ右シフトにジャンプ        | 
|      |          |         |               |                         | 
| 8440 |          |         | ORG 8440H     |                         | 
| 8440 | 21 00 40 | TIMER:  | LD HL, 4000H  | 値400HをHLレジスタに転送         | 
| 8443 | 5F       |         | LD E, A       | Aレジスタの値をEレジスタに転送        | 
| 8444 | 2B       | TLOOP:  | DEC HL        | HLレジスタの値から１を引く          | 
| 8445 | 7C       |         | LD A, H       | Hレジスタの値をAレジスタに転送        | 
| 8446 | B5       |         | OR L          | Aの値とLの値の論理和をとる          | 
| 8447 | 20 FB    |         | JR NZ, TLOOP  | フラグレジスタがNZならばTLOOPにジャンプ | 
| 8449 | 7B       |         | LD A,E        | Eレジスタの値をAレジスタに転送        | 
| 844A | C9       |         | RET           | ルーティン終了                 | 
| 844B |          |         | END           |                         | 

<div style="text-align:center;">図1.10 課題10</div>

## 考察課題
### 考察課題1
アセンブリ言語は低級言語といわれている。
定休言語とはなにか報告しなさい。

低級言語とは機械語に近いプログラミング言語のことである。
人間の使う言語とは程遠く、機械語に近い。

### 考察課題2
プログラミング言語には高級言語と呼ばれるものがある。
高級言語とはなにか報告しなさい。
また、高級言語の例を2つ報告し、それぞれの言語が主にどのような用途で使われるかなどの特徴も報告しなさい。

英単語等が使用されており人間の使う言語に近い。
コンパイラやインタープリタで機械語に変換される。

#### 例1
COBOL
Common Business Oriented Languageのこと

私が思う最初の高級言語。
グレース・ホッパーの理念として「機械語ではなく、英語に近い言語によってプログラミングできるようになるべきである」があり、そこから誕生した。
未だに銀行等の事務処理で使用されている。
helloworldのサンプルコードを図2.1.1に示す。
```
000010 IDENTIFICATION                   DIVISION.
000020 PROGRAM-ID.                      SAMPLE-01.
000030*
000040 ENVIRONMENT                      DIVISION.
000050*
000060 DATA                             DIVISION.
000070*
000080 PROCEDURE                        DIVISION.
000090 MAIN.
000100     DISPLAY "Hello world!"  UPON CONSOLE.
000110     STOP RUN.
```
<div style="text-align:center;">図2.1.1 helloworld</div>

出力結果を図2.2.2に示す。
```
Hello world!
```
<div style="text-align:center;">図2.1.2 output</div>

#### 例2
Brainfuck または Brainf*ck

可読性は低い。
チューリング完全なプログラミング言語。
ポインタと入力を扱う8つの命令によって成立している。
コンパイラを用いて機械語に翻訳する。
helloworldのサンプルコードを図2.2.1に示す。
```
>+++++++++[<++++++++>-]<.>+++++++[<++++>-]<+.+++++++..+++.[-]>++++++++[<++
++>-]<.>+++++++++++[<+++++>-]<.>++++++++[<+++>-]<.+++.------.--------.[-]>
++++++++[<++++>-]<+.[-]++++++++++.
```
<div style="text-align:center;">図2.2.1 helloworld</div>

出力結果を図2.2.2に示す。
```
Hello World!
```
<div style="text-align:center;">図2.2.2 output</div>
